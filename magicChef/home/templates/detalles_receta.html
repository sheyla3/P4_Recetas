{% extends 'core/baseUser.html' %}

{% block title %}
  {{ receta.titulo }}
{% endblock %}

{% block content %}
  <div class="container is-max-widescreen my-5">
    <h1>{{ receta.titulo }}</h1>
    <p>{{ receta.descripcion }}</p>

    {% if not ingredientes %}
      <strong><p style="text-align:center;height: 50px;">No hay ingredientes en este momento.</p></strong>
    {% else %}
      <h2>Ingredientes</h2>
      <ul>
        {% for ingrediente in ingredientes %}
          <li>{{ ingrediente.id_ingrediente.nombre }}: {{ ingrediente.cantidad }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    {% if not fotos %}
      <div>
        <strong><p style="text-align:center;height: 50px;">No hay fotos en este momento.</p></strong>
        {% else %}
        <h2>Fotos</h2>
        {% for foto in fotos %}
          <img src="{{ foto.foto.url }}" alt="Foto de {{ receta.titulo }}" />
        {% endfor %}
      </div>
    {% endif %}

    <h2>Comentarios</h2>
    <div class="comentarios">
      {% if comentarios %}
        {% for comentario in comentarios %}
          <div class="comentario">
            <p>
              <strong>{{ comentario.id_usuario.apodo }}</strong> ({{ comentario.fecha_creacion }}):
            </p>
            <p>{{ comentario.comentario }}</p>
            <p>Calificaci√≥n: {{ comentario.calificacion }} <i class="fas fa-star"></i></p>
          </div>
        {% endfor %}
      {% else %}
        <p>Deja el primer comentario</p>
      {% endif %}
    </div>
    {% if not user %}
      <strong><p style="text-align:center;height: 50px;">Necesitas estar registrado para dejar comentario.</p></strong>
    {% else %}
      <h3>Agregar un comentario</h3>
      <form method="post">
        {% csrf_token %}
        <div>
          {{ form.comentario.label_tag }}<br />
          {{ form.comentario }}
        </div>
        <div class="rating">
          {% for i in form.calificacion.field.choices %}
            <input type="radio" id="star{{ forloop.counter }}" name="calificacion" value="{{ forloop.counter }}" />
            <label title="{{ i.1 }}" for="star{{ forloop.counter }}">
              <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512">
                <path d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"></path>
              </svg>
            </label>
          {% endfor %}
        </div>
        <button type="submit">Enviar</button>
      </form>
    {% endif %}
  </div>
  <style>
    .rating {
      display: flex;
      flex-direction: row-reverse;
      justify-content: center;
    }
    .rating > input {
      display: none;
    }
    .rating > label {
      cursor: pointer;
      width: 30px;
      height: 30px;
      margin: 0 4px;
      color: #ffd700;
    }
    .rating > label svg {
      width: 100%;
      height: 100%;
    }
    .rating > input:checked ~ label svg {
      fill: #ffd700;
    }
    .rating > label:hover,
    .rating > label:hover ~ label {
      fill: #ffd700;
    }
    .rating > input:checked ~ label:hover,
    .rating > input:checked ~ label:hover ~ label,
    .rating > input:checked ~ label:hover ~ input:checked ~ label {
      fill: #ffd700;
    }
  </style>
{% endblock %}
